---
layout: post
title: "OSI Layer의 네트워크 계층"
date: 2022-01-12
categories: network
---

# OSI Layer의 네트워크 계층

데이터 링크 계층은 콜리전 도메인을 나누어 다른 콜리전 도메인끼리 통신을 가능하게 했다면 네트워크 계층은 브로드캐스트 도메인(브로드캐스트 통신이 가능한 영역)을 나누어서 다른 브로드캐스트 도메인끼리 통신이 가능하도록 한다.  네트워크 계층에서의 프로토콜은 ip프로토콜을 사용하고 장비로는 라우터가 있다. 

## 1. 라우터의 기능

![network-04-01](/public/images/network-04-01.webp)

1) 브로드캐스트 도메인에 대한 분리

브로드캐스트 도메인의 크기 너무 크면 브로드캐스트 통신이 발생 할때 불필요한 네트워크 통신 비용이 발생 할 수 있으므로 적절한 크기로 브로드캐스트 도메인은 상정하고 브로드캐스트 도메인들을 연결하는 것이 중요하다.만약 모든 네트워크가 하나의 브로드캐스트 도메인을 사용한다고 하면 지구에서 발생한 모든 브로드캐스트 통신이 나의 pc에서 처리 될 것이고 우리는 브로드캐스트 처리만 해서 네트워크를 사용하지 못 하는 pc를 가지게 될 것이다. 

2) 패킷 필터링 기능

네트워크 주소에 따라 전송을 막았다 풀었다 함으로써 특정 네트워크 주소에 대한 노드만 접근하도록 할 수 있다. 이러한 기능은 보안적으로 많이 사용되고 있다.

3) 로드 분배

라우터는 여러개의 경로를 가지고 있다. 하나의 경로에 문제가 발생해도 다른 경로를 통해서 통신하도록 할 수 있다.

4) QoS(Quality of Service)

프로토콜이나 데이터의 크기 중요도에 따라 트래픽에 전송에 대한 우선순위를 설정 할 수 있다.

## IP 주소

1) ip주소란?

TCP/IP 프로토콜을 사용하는 장비를 구분하기 위한 4옥텟(Octet)의 이진수이다. 4옥텟이므로 2의 32승개 정도 약 42억 9000개를 사용 할 수 있다. TCP/IP 통신을 하는 모든 장비에는 ip주소가 할당되어 있다. TCP/IP통신 할 때 타겟 즉 누구에게 보내는지 알아야 통신을 할 수 있기 때문에 당연한 말이다.

2) ip주소의 구성

![network-04-02](/public/images/network-04-02.png)

ip주소는 크게 네트워크 부분과 호스트 부분으로 나누어져 있다. 네트워크는 브로드캐스트 도메인을 지칭한다. 호스트는 그 네트워트 즉 브로드캐스트 영역에 속해 있는 노드들을 지칭한다. 예를 들면 위의 그림과 같은 192.168.1.1 이라는 ip주소가 있다고 하자. 첫 번째 옥텟을 네트워크 부분이라고 하면 해당 네트워크의 모든 ip의 첫번째 옥텟은 192이다. 그리고 나머지 셋 옥텟은 호스트 부분으로 다르다. 해당 네트워크의 호스트 부분은 3옥텟이므로 호스트의 최대 개수는 약 256 x 256 x 256까지 생성 할 수 있다.

3) 라우터의 ip주소

router도 네트워크 계층의 장비이므로 ip주소가 할당되어 있다. 라우터는 두 종류의 ip주소를 가지게 되는데 하나는 이더넷 인터페이스에 할당되는 ip이고 하나는 시리얼 인터페이스에 할당되는 ip이다. 

이더넷 인터페이스에 할당되는 ip는 내부용 ip로 내부 네트워크의 라우터 포트에 연결된다. ip는 내부 네트워크의 네트워크 부분과 같을 것이고 호스트 부분은 일반적으로 1을 사용한다. 리눅스에서 route나 혹은 netstat 명령어를 사용하면 Gateway의 ip주소를 볼 수 있는데 Gateway ip의 호스트 부분이 1일걸 확인 할 수 있다. 이는 해당 Gateway가 해당 리눅스와 연결되어 있는 라우터의 ip이기 때문이다. 

시리얼 인터페이스에 할당되는 ip는 외부용으로 외부 네트워크의 라우터 포트와 연결된다. 이 ip도 마찬가지로 외부 네트워크와 네트워크 부분은 같을 것이다. 이 ip는 공인 ip로 ISP(Internet Service Provider)로 부터 할당받아야 외부 인터넷과 연결되어 사용 할 수 있다.

<!-- ## IP주소의 Class -->

<!-- ## Netmask -->

