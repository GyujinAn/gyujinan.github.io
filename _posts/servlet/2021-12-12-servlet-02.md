---
layout: post
title: "웹 어플리케이션 아키텍처"
date: 2021-12-12
categories: servlet
---


# chapter2 웹 어플리케이션 아키텍처

## 학습목표

tomcat container의 기능과 구조를 이해한다.

### 1.tomcat container의 기능

Http 요청에 대한 처리는 서블릿이 하지만 각 서블릿을 관리는 tomcat container가 한다. 컨테이너는 서블릿 관리와 관련하여 다섯가지 기능을 한다. 

1.1 통신 커뮤니케이션

컨테이너는 클라이언트와 서블릿 간의 통신을 하도록 도와준다. 구체적으로는 java 통신과정으로는 

1) server socket 생성

2) 특정포트로 리스닝

3) 연결요청이 들어오면 stream 생성

과 같은 과정이 필요한데, 이러한 과정을 컨테이너가 해주고 해당 서블릿과 연결시켜준다.

<!-- 소켓통신과 stream에 대해서 소스코드에 찾아서 설명을 할 수 있으면 좋겠다. -->


1.2 서블릿 life cycle 관리

컨테이너는 서블릿의 life cycle을 관리한다. 구체적은 서블릿의 life cycle은

1) 서블릿 클래스 로딩

2) 서블릿 인스턴스 생성

3) 초기화

4) 서비스 호출

5) 서블릿 destory() 호출하여 종료

이다. 이러한 과정을 컨테이너에서 컨트롤한다. 

<!-- 생명주기 관리 대해서 소스코드에 찾아서 설명을 할 수 있으면 좋겠다. -->

1.3 멀티 쓰레드 지원

컨테이너는 멀티 쓰레드를 통해서 서블릿의 처리를 실행한다. 컨테이너의 멀티 쓰레드 관리는

1) 요청 감지

2) 새로운 쓰레드 생성 혹인 쓰레드 폴에서 호출

3) 새로운 쓰레드를 통해서 service() 실행

4) service()의 처리가 완료되면 쓰레드 반환

<!-- 멀티 쓰레드 지원 관리 대해서 소스코드에 찾아서 설명을 할 수 있으면 좋겠다. -->

1.4 선언적 보안 관리

DD(deployment descriptor)를 통해 보안 관리를 선언적으로 할 수 있다.

<!-- 컨테이너에서 어떻게 dd로 접근하여 데이터를 가져가는지 소스코드에 찾아서 설명을 할 수 있으면 좋겠다. -->


1.5 jsp 지원

톰캣컨테이너에서 jsp를 지원함으로써 톰캠 웹 어플리케이션은 mvc로 구성 할 수 있게 되었다. 여기서 model은 POJO(Plain Oid Java Object)로 view은 JSP(Java server pages)로 controller는 서블릿으로 개발된다. 

### 2. 서블릿의 고도화 과정 (mvc로 가는 과정)

2.1 서블릿의 service 메소드에 호출되는 doPost와 같은 함수에 비즈니스 로직과 프리젠테이션 로직이 공존 할 것이다. 

2.2 이런 로직은 비즈니스의 재사용을 힘들게 만든다. 비즈니스 로직이 쉽게 바뀔수 있는 프리젠테이션 로직을 의존하고 있으므로 프리젠테이션 로직이 바뀌는 경우 비즈니스 로직을 새롭게 작성해야한다.

2.3 비즈니스 로직의 재사용을 위해서 비즈니스 로직을 서블릿으로 부터 POJO형태로 분리시킨다.

2.4 비즈니스 로직은 분리된 클래스로 부터 인스턴스를 생성하여 호출된다. 그러면 프리젠테이션 로직이 바뀔 경우에도 비즈니스 로직은 인스턴스를 생성하여 호출 될 뿐이다.

2.5 서블릿에 프리젠테이션 로직을 작성하는 것은 많은 비용이 발생하므로 jsp를 통해서 작성되도록 서블릿으로 부터 분리 시킨다.

2.6 그러면 mvc 모델로 구성 된 웹 애플리케이션이 완성된다.

## 핵심정리

톰켓 컨테이너는 5가지 주요기능(clinet와 서블릿의 통신, 서블릿 생명 주기 관리, 멀티쓰레드 지원, 선언적 보안관리, jsp 지원)을 한다. 여기서 jsp 지원으로 인하여 톰캣 웹 어플리케이션은 mvc 구조로 개발 할 수 있는 프레임 워크가 되었다.